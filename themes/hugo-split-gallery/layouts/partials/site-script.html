{{ range slice "bootstrap/*.js" "jquery/*.js" "fancybox/*.js" "leaflet/*.js" "togeojson/*.js" "leaflet.awesome-markers/*.min.js" }}
{{ $secureJS := resources.GetMatch (printf "/vendor/%s" .) | resources.Fingerprint "sha512" }}
<script src="{{ $secureJS.Permalink }}" type="text/javascript" integrity="{{ $secureJS.Data.Integrity }}"></script>
{{ end }}

{{ if (default false ($.Site.Params.enableDownloadAll)) }}
{{ range slice "jszip/*.js" "jszip-utils/*.js" "file-saver/*.js" }}
{{ $secureJS := resources.GetMatch (printf "/vendor/%s" .) | resources.Fingerprint "sha512" }}
<script src="{{ $secureJS.Permalink }}" type="text/javascript" integrity="{{ $secureJS.Data.Integrity }}"></script>
{{ end }}
{{ end }}

{{ with resources.GetMatch "/hugo-split-gallery/map.js" }}<script src="{{ .Permalink }}"></script>{{ end }}
{{ if (default false ($.Site.Params.enableDownloadAll)) }}
{{ with resources.GetMatch "/hugo-split-gallery/zip.js" }}<script src="{{ .Permalink }}"></script>{{ end }}
{{ end }}

{{ $fancyboxParams := resources.GetMatch "/hugo-split-gallery/fancybox.js" | resources.ExecuteAsTemplate "hugo-split-gallery/fancybox.js" . }}
<script src="{{ $fancyboxParams.Permalink }}"></script>
{{ with resources.GetMatch (printf "/hugo-split-gallery/fancybox.%s.js" .Site.Language.Lang) }}<script src="{{ .Permalink }}"></script>{{ end }}

{{ range .Site.Params.customJs }}
<script src="{{ relURL (.) }}"></script>
{{ end }}


<script>
// Ensure content starts hidden, then fade in quickly
document.addEventListener('DOMContentLoaded', function() {
  setTimeout(() => {
    requestAnimationFrame(() => {
      document.body.classList.add('page-loaded');
    });
  }, 20); // Reduced from 50ms to 20ms
});

window.addEventListener('load', function() {
  document.body.classList.add('page-loaded');
});

// Handle link clicks
document.addEventListener('DOMContentLoaded', function() {
  const links = document.querySelectorAll('a');
  
  links.forEach(link => {
    link.addEventListener('click', function(e) {
      const href = this.getAttribute('href');
      
      if (!href || 
          href.startsWith('#') || 
          href.startsWith('http') || 
          href.startsWith('mailto:') || 
          href.startsWith('tel:') ||
          this.target === '_blank') {
        return;
      }
      
      e.preventDefault();
      document.body.classList.remove('page-loaded');
      
      setTimeout(() => {
        window.location.href = href;
      }, 150); // Reduced from 200ms to 150ms
    });
  });
});
</script>